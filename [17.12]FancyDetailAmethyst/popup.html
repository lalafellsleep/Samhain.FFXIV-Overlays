<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=760, user-scalable=no">
	<title>Fancy Detail Setting Window</title>
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/jquery-ui.min.js"></script>
	<link href="//fonts.googleapis.com/earlyaccess/notosanskr.css" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/css?family=Aldrich" rel="stylesheet" />
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
	<link href="css/setting.css" rel="stylesheet" />
</head>
<body>
	<div class="header" id="lang-setting">Setting</div>
	<button onclick="colorSave()" class="savebtn" data-label="savebtn">SAVE</button>
	<button class="resetbtn" data-label="resetbtn" onclick="option = origopt; 
	localStorage.setItem('fancyset', JSON.stringify(option)); window.opener.location = window.opener.location; window.close();">RESET</button>
	<div class="remotecontrol">
		<div data-label="set-inf" tag="information" default-tag="true" data-selected="true"></div>
		<div data-label="set-gen" tag="general"></div>
		<div data-label="set-bgs" tag="bgcss"></div>
		<div data-label="set-gnb" tag="barcommon"></div>
		<div data-label="set-adb" tag="baradvanced"></div>
		<div data-label="set-col" tag="columnset"></div>
		<div data-label="set-xim" tag="setting-in-out"></div>
	</div>
	<div class="colorEditor_v2" style="display:none;">
		<div class="window">
			<input type="hidden" name="data-from" />
			<input type="hidden" name="data-origin-color" />
			<div class="titleText">Color Picker</div>
			<div class="colorArea">
				<div class="paletteSelector"></div>
			</div>
			<div class="hueArea">
				<div class="hueHandle"></div>
			</div>
			<div class="alphaArea">
				<div class="alphaHandle"></div>
				<div class="alphaColor"></div>
			</div>
			<div class="colorDiff">
				<div class="newColor"></div>
				<div class="oldColor"></div>
			</div>
			<div class="clickAreaColor"></div>
			<div class="clickAreaHue"></div>
			<div class="clickAreaAlpha"></div>
			<input type="number" min="0" max="255" data-type="R" value="0" />
			<input type="number" min="0" max="255" data-type="G" value="0" />
			<input type="number" min="0" max="255" data-type="B" value="0" />
			<input type="number" min="0" max="255" data-type="A" value="0" />
			<input type="number" min="0" max="360" data-type="HUE" value="0" style="width:100px;" />
			<input type="number" min="0" max="100" data-type="SAT" value="0" style="width:100px;" />
			<input type="number" min="0" max="100" data-type="VAL" value="0" style="width:100px;" />

			<div class="closebtn">×</div>

			<div class="inputLabel" style="margin-bottom:90px;">R</div>
			<div class="inputLabel" style="margin-bottom:60px;">G</div>
			<div class="inputLabel" style="margin-bottom:30px;">B</div>
			<div class="inputLabel">A</div>
			<div class="inputLabel" style="margin-left:85px; margin-bottom:0px;">#</div>

			<div class="inputLabel" style="margin-left:85px; margin-bottom:90px;">Hue</div>
			<div class="inputLabel" style="margin-left:85px; margin-bottom:60px;">Sat</div>
			<div class="inputLabel" style="margin-left:85px; margin-bottom:30px;">Val</div>
			<div class="inputLabel" style="margin-left:225px; margin-bottom:90px; text-align:left; width:20px;">˚</div>
			<div class="inputLabel" style="margin-left:225px; margin-bottom:60px; text-align:left; width:20px;">%</div>
			<div class="inputLabel" style="margin-left:225px; margin-bottom:30px; text-align:left; width:20px;">%</div>

			<input type="text" value="000000" pattern="[A-Fa-f0-9]{6}" data-type="hex" />
			<div class="addpalette">Add This Color to Palette</div>
			<div class="acceptColor">Ok</div>
			<div class="palette">
				<div class="citems" style="background-color:#FFFFFF;" data-default="true"></div>
				<div class="citems" style="background-color:#EFE;" data-default="true"></div>
				<div class="citems" style="background-color:#CFF;" data-default="true"></div>
				<div class="citems" style="background-color:#7CF;" data-default="true"></div>
				<div class="citems" style="background-color:#0000A0;" data-default="true"></div>
				<div class="citems" style="background-color:#232898;" data-default="true"></div>
				<div class="citems" style="background-color:#4968E1;" data-default="true"></div>
				<div class="citems" style="background-color:#38B0B4;" data-default="true"></div>
				<div class="citems" style="background-color:#88CCCC;" data-default="true"></div>
				<div class="citems" style="background-color:#BFC;" data-default="true"></div>
				<div class="citems" style="background-color:#288A3B;" data-default="true"></div>
				<div class="citems" style="background-color:#00A000;" data-default="true"></div>
				<div class="citems" style="background-color:#B4D143;" data-default="true"></div>
				<div class="citems" style="background-color:#DF7;" data-default="true"></div>
				<div class="citems" style="background-color:#FE9;" data-default="true"></div>
				<div class="citems" style="background-color:#FF9;" data-default="true"></div>
				<div class="citems" style="background-color:#FEA;" data-default="true"></div>
				<div class="citems" style="background-color:#CFB090;" data-default="true"></div>
				<div class="citems" style="background-color:#B1A066;" data-default="true"></div>
				<div class="citems" style="background-color:#D9B028;" data-default="true"></div>
				<div class="citems" style="background-color:#FFD800;" data-default="true"></div>
				<div class="citems" style="background-color:#FCA;" data-default="true"></div>
				<div class="citems" style="background-color:#FB8;" data-default="true"></div>
				<div class="citems" style="background-color:#FFB000;" data-default="true"></div>
				<div class="citems" style="background-color:#D98028;" data-default="true"></div>
				<div class="citems" style="background-color:#A00000;" data-default="true"></div>
				<div class="citems" style="background-color:#921000;" data-default="true"></div>
				<div class="citems" style="background-color:#642324;" data-default="true"></div>
				<div class="citems" style="background-color:#600000;" data-default="true"></div>
				<div class="citems" style="background-color:#564848;" data-default="true"></div>
				<div class="citems" style="background-color:#644696;" data-default="true"></div>
				<div class="citems" style="background-color:#E579A8;" data-default="true"></div>
				<div class="citems" style="background-color:#F69;" data-default="true"></div>
				<div class="citems" style="background-color:#EBF;" data-default="true"></div>
			</div>
		</div>
	</div>
	<div class="content">
		<div class="group" label="" data-id="overlayinfo" tag="information" style="margin-bottom:30px;">
			<div class="item" style="cursor:default; text-align:left;">
				<div style="text-align:center; position:relative; margin-bottom:40px;">
					<div style="height:100px; position:absolute; right:50%; margin-right:55px; line-height:100px; font-size:16px; font-weight:bold;">FANCY DETAIL</div>
					<div style="height:100px; position:absolute; top:0px; left:50%; margin-left:55px; line-height:100px; font-size:16px; font-weight:bold;">ACT OVERLAY</div>
					<img src="image/trillion.svg" width="100" style="filter:drop-shadow(0px 0px 2px #000); -webkit-filter:drop-shadow(0px 0px 2px #000);"/>
					<div style="text-align:center; font-size:16px; font-weight:bold; color:#9C77D5;">AMETHYST EDITION</div>
					<div style="text-align:center;"><a href="https://github.com/laiglinne-ff/Project_TheStone/blob/master/LICENSE" target="_blank" style="display:inline-block; font-size:13px; text-decoration:none; border:1px solid #9C77D5; padding:2px; color:#9C77D5; padding-left:12px; padding-right:12px; border-radius:2px; margin-top:5px;">GNU GPL v3.0</a></div>
					<div style="margin-left:40px; margin-right:40px; padding:5px; text-align:center; border-top:2px solid #9C77D5; border-bottom:2px solid #9C77D5; margin-top:30px; text-align:center; color:#9C77D5;"><span style="font-size:12px;">Current Version</span><br><b>Square cushion cut</b><br>v1.2<br><br>
					<span style="font-size:13px;"><b>12/13 2017</b><br>
						Patch ColorPicker bugs and UI,<br>
						you can save color to palette.<br>
						and Overlay Header Customize now available!<br>
						additional things
					</span>	
					<br><br>
					<span style="font-size:12px;">Main Programmer</span><br><b>Laighlinne</b><br><br>
						<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">
							<input type="hidden" name="cmd" value="_s-xclick">
							<input type="hidden" name="hosted_button_id" value="4UVRYAGJE5DMW">
							<img src="image/paypal.png" style="margin:0 auto; width:100px; margin-bottom:10px; display:block;"/>
							<button name="submit" style="width:240px; height:30px; border-radius:15px; color:#FFF; border:none; background:#9C77D5; box-sizing:border-box; line-height:30px; padding:0px; font-size:15px; font-weight:bold; margin:0px;">DONATE</button>
							<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
						</form>
					</div>
					<div style="margin-left:40px; margin-right:40px; padding:5px; text-align:center; border-top:2px solid #9C77D5; border-bottom:2px solid #9C77D5; margin-top:30px; text-align:center; color:#9C77D5;">
						<b style="font-size:18px;">Patch Informations</b><br>
						<br>
						<b>Shield Cut <span style="font-size:12px;">v1.1</span></b><br>
						<b style="font-size:13px;">12/09 2017</b><br>
						<span style="font-size:13px;">
							Column editor and Setting Im/Export is now available!<br>
							You can editing overlay data columns<br>
							and Share your overlay setting.
						</span>
						<br><br>
						<b><i>Brilliant Cut hotfix</i> <span style="font-size:12px;">v1.0a</span></b><br>
						<b style="font-size:13px;">12/08 2017</b><br>
						<span style="font-size:13px;">
							Fixed Framedrop reason and Ninja Customizing option.
						</span>
						<br><br>
						<b>Brilliant Cut <span style="font-size:12px;">v1.0</span></b><br>
						<b style="font-size:13px;">12/05 2017</b><br>
						<span style="font-size:13px;">
							Renewal Setting page. you can customize many options.
						</span>
						<br><br>
						<b>Ceylon Cut <span style="font-size:12px;">v0.9b</span></b><br>
						<b style="font-size:13px;">10/17 2017</b><br>
						<span style="font-size:13px;">
							Added English language.
						</span>
					</div>
				</div>
			</div>
			<div class="item" style="cursor:default; text-align:left;">
				Cleave-ORE.JS v2.1.2<br>
				<div style="font-size:12px; line-height:15px;">MIT License<br>
					<br>
				Copyright (c) 2017 willowseo(aka Laighlinne)<br>
				<br>
				Permission is hereby granted, free of charge, to any person obtaining a copy
				of this software and associated documentation files (the "Software"), to deal
				in the Software without restriction, including without limitation the rights
				to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
				copies of the Software, and to permit persons to whom the Software is
				furnished to do so, subject to the following conditions:<br>
				<br>
				The above copyright notice and this permission notice shall be included in all
				copies or substantial portions of the Software.<br>
				<br>
				THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
				IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
				FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
				AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
				LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
				OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
				SOFTWARE.</div>
			</div>
		</div>
		<div class="group" label="UI" data-id="ui" tag="general">
			<div class="item" label="" data-id="nickhide">
				<div class="switch"></div>
			</div>
			<div class="item" label="" data-id="rankanim">
				<div class="switch"></div>
			</div>
			<div class="item" label="" data-id="numbanim">
				<div class="switch"></div>
			</div>
			<div class="item" label="" data-id="nickshorter" style="cursor:default;">
				<select>
					<option data-label="notuse" value="n0">Aquamarin Diamond (사용 안 함)</option>
					<option data-label="nameval1" value="n1">Aquamarin D. (뒷 이름 줄이기)</option>
					<option data-label="nameval2" value="n2">A. Diamond (앞 이름 줄이기)</option>
					<option data-label="nameval3" value="n3">A. D. (모두 줄이기)</option>
				</select>
			</div>
		</div>
		<div class="group" label="Data" data-id="data" tag="general">
			<div class="item" label="" data-id="hpsallview">
				<div class="switch"></div>
			</div>
			<div class="item" label="" data-id="displayhps">
				<div class="switch"></div>
			</div>
		</div>
		<div class="group" label="CSS" data-id="css" flag="advanced" tag="bgcss" style="margin-bottom:30px;">
			<div class="item" style="cursor:default; text-align:left;">
				<div style="position:relative; overflow:none;">
					<div data-set="headercolor" style="min-height:36px; position:abolute; left:2px; top:2px; right:2px; bottom:calc(100% - 38px); font-family:'맑은 고딕'; box-shadow:0px 0px 2px rgba(0,0,0,0.5) !important; border-radius:4px; background:rgba(75, 0, 187, 0.5); color:#FFF; text-shadow:0px 0px 1px #000, 0px 0px 1px #808080, 0px 0px 1px #808080, 0px 0px 2px #808080, 0px 0px 3px #404040; -webkit-filter:drop-shadow(0px 0px 2px rgba(0,0,0,0.3)); filter:drop-shadow(0px 0px 2px rgba(0,0,0,0.3)); overflow:hidden; transition:0.5s; z-index:100;">
						<div style="margin:5px; height:26px; line-height:26px; font-size:24px; width:calc(100% - 150px);">
							<div style="width:24px; height:24px; border-radius:50%; border:2px solid #FFF; box-sizing:border-box; margin:1px; float:left; text-shadow:none;"><i class="material-icons" style="font-size:20px;">schedule</i></div>
							<div style="font-family:'Aldrich'; line-height:28px; padding-left:2px;">
								12:34
							</div>
							<div style="width:24px; height:24px; box-sizing:border-box; border:2px solid #FFF; border-radius:50%; position:absolute; right:6px; top:6px; text-shadow:none;"><i class="material-icons" style="font-size:20px;">settings</i></div>
						</div>
					</div>
				</div>
				<div class="coloreditor" label="" data-id="topbgcolor" data-for="headercolor" data-value="rgba(75,0,187,0.5)" style="margin-top:20px;"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" data-id="bgcolor" notext="true" data-value="rgba(0,0,0,0.0)"></div>
				<div class="imageurlpicker" label="" back="bgcolor" data-id="image"></div>
			</div>
		</div>
		<div class="group" label="CSS" data-id="etcicon" flag="advanced" tag="barcommon">
			<div class="item" label="Opacity" data-id="opacity" style="cursor:default;">
				<input type="range" min="0" max="100" value="100" step="1" />
				<span class="view" after="%">100</span>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" notext="true" data-id="iconglow" data-value="#AB7813"></div>
			</div>
			<div class="item" data-id="fonts" style="cursor:default;">
				<input type="text" onchange="colorSave();" />
			</div>
			<div class="item" data-id="fontsize" style="cursor:default;">
				<input type="number" onchange="colorSave();" min="12" max="72"/>
			</div>
		</div>
		<div class="group" label="CSS" data-id="rolecolor" flag="advanced" tag="barcommon">
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" notext="true" image="background-image:url(./image/icons.png); background-repeat:no-repeat; background-position:-96px -96px; background-size:240px 120px; width:24px; height:24px; filter:drop-shadow(0px 0px 1px ${iconglow}) drop-shadow(0px 0px 1px ${iconglow}); -webkit-filter:drop-shadow(0px 0px 1px ${iconglow}) drop-shadow(0px 0px 1px ${iconglow});" data-id="c_tanker" data-value="#0000A0"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" notext="true" image="background-image:url(./image/icons.png); background-repeat:no-repeat; background-position:-96px -96px; background-size:240px 120px; width:24px; height:24px; filter:drop-shadow(0px 0px 1px ${iconglow}) drop-shadow(0px 0px 1px ${iconglow}); -webkit-filter:drop-shadow(0px 0px 1px ${iconglow}) drop-shadow(0px 0px 1px ${iconglow});" data-id="c_healer" data-value="#00A000"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" notext="true" image="background-image:url(./image/icons.png); background-repeat:no-repeat; background-position:-96px -96px; background-size:240px 120px; width:24px; height:24px; filter:drop-shadow(0px 0px 1px ${iconglow}) drop-shadow(0px 0px 1px ${iconglow}); -webkit-filter:drop-shadow(0px 0px 1px ${iconglow}) drop-shadow(0px 0px 1px ${iconglow});" data-id="c_dps" data-value="#A00000"></div>
			</div>
		</div>
		<div class="group" label="CSS" data-id="tankers" flag="advanced" tag="baradvanced">
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="glapldf" notext="true" data-id="glapld" data-value="#88CCCC"></div>
				<div class="coloreditor" label="" back="glapld" data-id="glapldf" data-value="#CCFFFF"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="mrdwarf" notext="true" data-id="mrdwar" data-value="#921000"></div>
				<div class="coloreditor" label="" back="mrdwar" data-id="mrdwarf" data-value="#FFCCAA"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="drkf" notext="true" data-id="drk" data-value="#642324"></div>
				<div class="coloreditor" label="" back="drk" data-id="drkf" data-value="#FFBB88"></div>
			</div>
		</div>
		<div class="group" label="CSS" data-id="healers" flag="advanced" tag="baradvanced">
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="cnjwhmf" notext="true" data-id="cnjwhm"  data-value="#CFB090"></div>
				<div class="coloreditor" label="" back="cnjwhm" data-id="cnjwhmf" data-value="#FFEEAA"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="schf" notext="true" data-id="sch"  data-value="#232898"></div>
				<div class="coloreditor" label="" back="sch" data-id="schf" data-value="#EEFFEE"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="astf" notext="true" data-id="ast"  data-value="#D98028"></div>
				<div class="coloreditor" label="" back="ast" data-id="astf" data-value="#FFFF99"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" data-id="overhealcolor" data-value="#600000"></div>
			</div>
		</div>
		<div class="group" label="CSS" data-id="dealers" flag="advanced" tag="baradvanced">
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="pglmnkf" notext="true" data-id="pglmnk"  data-value="#D9B028"></div>
				<div class="coloreditor" label="" back="pglmnk" data-id="pglmnkf" data-value="#FFEE99"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="lncdrgf" notext="true" data-id="lncdrg"  data-value="#4968E1"></div>
				<div class="coloreditor" label="" back="lncdrg" data-id="lncdrgf" data-value="#77CCFF"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="rogninf" notext="true" data-id="rognin"  data-value="#564848"></div>
				<div class="coloreditor" label="" back="rognin" data-id="rogninf" data-value="#FF6699"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="samf" notext="true" data-id="sam"  data-value="#B1A066"></div>
				<div class="coloreditor" label="" back="sam" data-id="samf" data-value="#FEFEFE"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="arcbrdf" notext="true" data-id="arcbrd"  data-value="#B4D143"></div>
				<div class="coloreditor" label="" back="arcbrd" data-id="arcbrdf" data-value="#DDFF77"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="mchf" notext="true" data-id="mch"  data-value="#38B0B4"></div>
				<div class="coloreditor" label="" back="mch" data-id="mchf" data-value="#BBFFCC"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="thmblmf" notext="true" data-id="thmblm"  data-value="#644696"></div>
				<div class="coloreditor" label="" back="thmblm" data-id="thmblmf" data-value="#EEBBFF"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="acnsmnf" notext="true" data-id="acnsmn"  data-value="#288A3B"></div>
				<div class="coloreditor" label="" back="acnsmn" data-id="acnsmnf" data-value="#DDFF77"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="rdmf" notext="true" data-id="rdm"  data-value="#E579A8"></div>
				<div class="coloreditor" label="" back="rdm" data-id="rdmf" data-value="#FFFFFF"></div>
			</div>
			<div class="item" style="cursor:default;">
				<div class="coloreditor" label="" font="lmbf" notext="true" data-id="lmb"  data-value="#FFB000"></div>
				<div class="coloreditor" label="" back="lmb" data-id="lmbf" data-value="#FFFFFF"></div>
			</div>
		</div>
		<div class="group" label="" data-id="columnset" tag="columnset">
			<div class="item" style="cursor:default; position:relative; overflow:auto;">
				<div style="height:50px; position:relative;">
					<div data-label="columnsetdesc" style="text-align:left;">You can dragging order, Double click switch show/hide</div>
					<div style="left:10px; top:30px; position:absolute;">Data name</div>
					<div style="left:242px; top:30px; position:absolute;">Data name</div>
					<div style="left:138px; top:30px; position:absolute;">Width</div>
					<div style="left:370px; top:30px; position:absolute;">Width</div>
				</div>
				<ul id="sortable-dps"></ul>
				<ul id="sortable-hps"></ul>
			</div>
		</div>
		<div class="group" label="" data-id="setting-in-out" tag="setting-in-out">
			<div class="item" style="cursor:default; position:relative; overflow:auto;">
				<div data-label="setexport" style="padding:5px;"></div>
				<textarea id="settingtxt" disabled="disabled" style="resize:none; width:100%; height:180px; overflow:auto; user-select: all; -webkit-user-select: all;"></textarea><br>
				<div data-label="setimport" style="padding:5px;"></div>
				<textarea id="settingtxt_import" style="resize:none; width:100%; height:180px; overflow:auto; user-select: all; -webkit-user-select: all;"></textarea>
				<div class="allowbtn" onclick="allowset();">Allow Setting File</div>
			</div>
		</div>
	</div>
</body>
<script src="js/lang.js"></script>
<script>
var set = JSON.parse(localStorage.getItem("fancyset"));
if (set != null)
	option = set;
</script>
<script>
	// ColorEditor 2
	var CEditor = new initEditor($(".colorEditor_v2")[0]);
	function initEditor(editor)
	{
		this.moveColorCursor = function(x, y)
		{
			$colorcursor.css({"left":x, "top":y});
			this.syncColor();
		}

		this.moveHueCursor = function(y)
		{
			$hue.css("top", y); 
			this.syncColor();
		}

		this.moveAlphaCursor = function(y)
		{
			$alpha.css("top", y);
			this.syncColor();
		}

		this.syncColor = function(bool)
		{
			var rgb = this.hsvToRgb();
			var hrgb = this.hsvToRgb(true);
			$color.css("background", "linear-gradient(to right, #FFF 0%, rgb(" + hrgb.r + "," + hrgb.g + "," + hrgb.b + ") 100%)");
			var a = (255 - parseInt($alpha.css("top"))) / 255;
			$newColor.css("background", "linear-gradient(to bottom, rgb(" + rgb.r + "," + rgb.g + "," + rgb.b + ") 0%, rgba(" + + rgb.r + "," + rgb.g + "," + rgb.b + "," + a + ")");
			$alphabar.css("background", "linear-gradient(to bottom, rgb(" + rgb.r + "," + rgb.g + "," + rgb.b + ") 0%, rgba(" + + rgb.r + "," + rgb.g + "," + rgb.b + ",0)");

			if(bool != undefined)
			{
				if(!bool)
					return;
			}

			$this.find("[data-type=R]").val(rgb.r);
			$this.find("[data-type=G]").val(rgb.g);
			$this.find("[data-type=B]").val(rgb.b);
			$this.find("[data-type=A]").val(a * 100);
			$this.find("[data-type=HUE]").val((parseInt($hue.css("top")) / 255 * 359).toFixed(3));
			$this.find("[data-type=SAT]").val((parseInt($colorcursor.css("left")) / 255 * 100).toFixed(3));
			$this.find("[data-type=VAL]").val((100 - (parseInt($colorcursor.css("top")) / 255 * 100)).toFixed(3));
			$this.find("[data-type=hex]").val(this.rgb2Hex({"r":rgb.r, "g":rgb.g, "b":rgb.b, "a":a}));
		}

		this.hsvToRgb = function(gethue) 
		{
			var r, g, b, h = parseInt($hue.css("top")), s = parseInt($colorcursor.css("left")), v = 255 - parseInt($colorcursor.css("top")), i, f, p, q, t;
			if(gethue != undefined)
			{
				s = 255;
				v = 255;
			}
			h /= 2.55; s /= 2.55; v /= 2.55;h = h * 3.59;
			h = Math.max(0, Math.min(360, h)); s = Math.max(0, Math.min(100, s)); v = Math.max(0, Math.min(100, v));
			s /= 100; v /= 100;
			if(s==0) {r=g=b=v; return {r:Math.round(r * 255), g:Math.round(g * 255), b:Math.round(b * 255)};}
			h /= 60;i = Math.floor(h);f = h - i;p = v * (1 - s);q = v * (1 - s * f);t = v * (1 - s * (1 - f));
			switch(i) 
			{
				case 0:r=v;g=t;b=p;break;
				case 1:r=q;g=v;b=p;break;
				case 2:r=p;g=v;b=t;break;
				case 3:r=p;g=q;b=v;break;
				case 4:r=t;g=p;b=v;break;
				default:r=v;g=p;b=q;
			}
			return {r:Math.round(r * 255), g:Math.round(g * 255), b:Math.round(b * 255)};
		}

		this.rgb2Hsv = function(rgb)
		{
			var r = rgb.r;
			var g = rgb.g;
			var b = rgb.b;

			r /= 255, g /= 255, b /= 255;
			var max = Math.max(r, g, b), min = Math.min(r, g, b);
			var h, s, v = max;
			var d = max - min;
			s = max == 0 ? 0 : d / max;
			if (max == min) 
			{
				h = 0;
			} 
			else 
			{
				switch (max)
				{
					case r: h = (g - b) / d + (g < b ? 6 : 0); break;
					case g: h = (b - r) / d + 2; break;
					case b: h = (r - g) / d + 4; break;
				}
				h /= 6;
			}

			return {"h":h, "s":s, "v":v};
		}

		this.str2rgb = function(str) 
		{
			var rgb = /rgb\(([0-9\s]*?),([0-9\s]*?),([0-9\s]*?)\)/;
			var rgba = /rgba\(([0-9\s]*?),([0-9\s]*?),([0-9\s]*?),([0-9.\s]*?)\)/;
			var hex = /#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})/;
			var hexa = /#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})/;
			var hex2 = /#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])/;

			var r, g, b, a;
			a = 1;

			if(rgba.test(str)) 
			{
				r = parseInt(str.match(rgba)[1]);
				g = parseInt(str.match(rgba)[2]);
				b = parseInt(str.match(rgba)[3]);
				a = parseFloat(str.match(rgba)[4]);
			} 
			else if (rgb.test(str)) 
			{
				r = parseInt(str.match(rgb)[1]);
				g = parseInt(str.match(rgb)[2]);
				b = parseInt(str.match(rgb)[3]);
			}
			else if (hexa.test(str)) 
			{
				r = parseInt(str.match(hexa)[1], 16);
				g = parseInt(str.match(hexa)[2], 16);
				b = parseInt(str.match(hexa)[3], 16);
				a = parseInt(str.match(hexa)[4], 16) / 255;
			}
			else if (hex.test(str)) 
			{
				r = parseInt(str.match(hex)[1], 16);
				g = parseInt(str.match(hex)[2], 16);
				b = parseInt(str.match(hex)[3], 16);
			}
			else if(hex2.test(str))
			{
				r = parseInt(str.match(hex2)[1] + str.match(hex2)[1], 16);
				g = parseInt(str.match(hex2)[2] + str.match(hex2)[2], 16);
				b = parseInt(str.match(hex2)[3] + str.match(hex2)[3], 16);
			}

			return {
				"r": parseInt(r),
				"g": parseInt(g),
				"b": parseInt(b),
				"a": parseFloat(a)
			};
		}

		this.clickAction = function(e)
		{
			var x = Math.floor(e.clientX - $color.offset().left) - 1;
			var y = Math.floor(e.clientY - $color.offset().top) - 1;
			if(x < 0) x = 0;
			if(y < 0) y = 0;
			if(x > $color.width() - 1) x = $color.width() - 1;
			if(y > $color.height() - 1) y = $color.height() - 1;
			this.moveColorCursor(x, y);
		}

		this.openColorEditor = function(sender, np)
		{
			$this.show();
			if(np == undefined)
				this.op = $(sender)[0];
			var rgba = this.str2rgb($(sender).css("background-color"));
			var hsv = this.rgb2Hsv(rgba);
			var h = Math.round(hsv.h * 255);
			var s = Math.round(hsv.s * 255);
			var v = 255 - Math.round((hsv.v * 255));
			var a = 255 - Math.round(rgba.a * 255);
			$this.find("input[name=data-origin-color]").val(hsv);

			$oldColor.css("background", "linear-gradient(to bottom, rgb(" + rgba.r + "," + rgba.g + "," + rgba.b + ") 0%, rgba(" + + rgba.r + "," + rgba.g + "," + rgba.b + "," + rgba.a + ")");
			$colorcursor.css({"left": s + "px", "top": v + "px"});
			$hue.css("top", h + "px");
			$alpha.css("top", a + "px");
			this.setRGBHSV(rgba, hsv);
			this.syncColor(false);
		}

		this.setRGBHSV = function(rgba, hsv)
		{
			$this.find("[data-type=R]").val(rgba.r);
			$this.find("[data-type=G]").val(rgba.g);
			$this.find("[data-type=B]").val(rgba.b);
			$this.find("[data-type=A]").val(rgba.a * 100);
			$this.find("[data-type=HUE]").val((hsv.h * 359).toFixed(3));
			$this.find("[data-type=SAT]").val((hsv.s * 100).toFixed(3));
			$this.find("[data-type=VAL]").val((hsv.v * 100).toFixed(3));
			$this.find("[data-type=hex]").val(this.rgb2Hex(rgba));
		}

		this.rgb2Hex = function(rgba)
		{
			var hex = "";
			hex += rgba.r.toString(16).length == 1 ? "0" + rgba.r.toString(16) : rgba.r.toString(16);
			hex += rgba.g.toString(16).length == 1 ? "0" + rgba.g.toString(16) : rgba.g.toString(16);
			hex += rgba.b.toString(16).length == 1 ? "0" + rgba.b.toString(16) : rgba.b.toString(16);
			if(rgba.a != 1)
			{
				hex += (Math.floor(rgba.a * 255).toString(16)).length == 1 ? "0" +  Math.floor(rgba.a * 255).toString(16) :  Math.floor(rgba.a * 255).toString(16);
			}
			return hex;
		}

		this.rgba2str = function(rgba)
		{
			return "rgba(" + rgba.r + "," + rgba.g + "," + rgba.b + "," + rgba.a.toFixed(2) +")";
		}

		this.clickHueAction = function(e)
		{
			var y = Math.floor(e.clientY - $color.offset().top) - 2;
			if(y < 0) y = 0;
			if(y > $color.height() - 1) y = $color.height() - 1;
			this.moveHueCursor(y);
		}

		this.clickAlphaAction = function(e)
		{
			var y = Math.floor(e.clientY - $color.offset().top) - 2;
			if(y < 0) y = 0;
			if(y > $color.height() - 1) y = $color.height() - 1;
			this.moveAlphaCursor(y);
		}

		this.addPalette = function(x)
		{
			var v = localStorage.getItem("fancyColorpalette");
			if(v == undefined) v = "";
			v = v.split(":");
			v += ":" + This.rgb2Hex(x);
			localStorage.setItem("fancyColorpalette", v);

			$this.find(".palette").prepend('<div class="citems" style="background-color:' + This.rgba2str(x) + ';"></div>');
		}

		this.acceptColor = function(color, sender)
		{
			var rgba = "rgba(" + $r.val() + "," + $g.val() + "," + $b.val() + "," + parseFloat($a.val()) / 100 + ")";
			if(color != undefined)
			{
				rgba = this.rgba2str(color);
				this.op = sender;
			}
			var dataid = $(This.op).parent().parent().attr("data-id");
			$(this.op).css("background-color", rgba);
			option[dataid] = rgba;
			option["backgroundimg"] = $(".imageurlpicker>.imagearea>.image").attr("style");
			window.opener.option = option;
			window.opener.setCSS();
			saveSetting();
			$("#settingtxt").val(JSON.stringify(option, null, 4));
			if($(this.op).parent().parent().attr("data-for") != undefined)
			{
				$("[data-set=" + $(this.op).parent().parent().attr("data-for") + "]").each(function()
				{
					var css = $(this).attr("data-target");
					if(css == undefined)
						css = "background-color";

					$(this).css(css, rgba);
				});
			}
			$this.hide();
		}

		this.op = undefined;
		var $this = $(editor);
		var This = this;
		var $color = $this.find(".colorArea");
		var $colorcursor = $this.find(".paletteSelector");
		var $hue = $this.find(".hueHandle");
		var $alpha = $this.find(".alphaHandle");
		var $alphabar = $this.find(".alphaColor");
		var $newColor = $this.find(".newColor");
		var $oldColor = $this.find(".oldColor");
		var $r = $this.find("input[data-type=R]");
		var $g = $this.find("input[data-type=G]");
		var $b = $this.find("input[data-type=B]");
		var $a = $this.find("input[data-type=A]");
		var clickType;

		// events
		$this.find(".clickAreaColor")
		.click(function(e)
		{
			This.clickAction(e);
		});

		$this.find(".clickAreaHue")
		.click(function(e)
		{
			This.clickHueAction(e);
		});

		$this.find(".clickAreaAlpha")
		.click(function(e)
		{
			This.clickAlphaAction(e);
		});

		$this.find(".palette>.citems").click(function()
		{
			This.openColorEditor(this, true);
		});

		$this
		.mousedown(function(e)
		{	
			if(e.target.className == "clickAreaColor")
				clickType = "color";
			if(e.target.className == "clickAreaHue")
				clickType = "hue";
			if(e.target.className == "clickAreaAlpha")
				clickType = "alpha";
			if(e.target.className == "closebtn")
				$this.hide();
			if(e.target.className == "addpalette")
			{
				var i;
				var x = {"r":parseInt($r.val()), "g":parseInt($g.val()), "b":parseInt($b.val()), "a":(parseFloat($a.val()) / 100)};
				$this.find(".citems").each(function()
				{
					var m = This.str2rgb($(this).css("background-color"));
					if(x.r == m.r && x.g == m.g && x.b == m.b && x.a.toFixed(2) == m.b.toFixed(2))
					{
						i = true;
					}
				});

				if(i) return;
				This.addPalette(x);
			}
			if(e.target.className == "acceptColor")
			{
				This.acceptColor();
			}
		})
		.mouseup(function(e)
		{
			clickType = undefined;
		})
		.mousemove(function(e)
		{
			if(clickType == "color")
			{
				This.clickAction(e);
			}
			else if(clickType == "hue")
			{
				This.clickHueAction(e);
			}
			else if(clickType == "alpha")
			{
				This.clickAlphaAction(e);
			}
		});

		$(document)
		.mouseleave(function()
		{
			cilckType = undefined;
		});
	}
	
	$(".coloreditor")
	.each(function()
	{
		$(this).append('<div class="colorEditBtn"></div>');
		$(this).append('<div class="reset"><i class="material-icons">refresh</i></div>');
		$(this).find('.colorEditBtn').append('<div></div>');

		$(this).find(".reset").click(function()
		{
			CEditor.acceptColor(CEditor.str2rgb($(this).parent().attr("data-value")), $(this).parent().find(".colorEditBtn>div"));
		});

		$(this).find(".colorEditBtn>div").click(function()
		{
			CEditor.openColorEditor($(this));
		});

		var set = option[$(this).attr("data-id")];
		if(set != undefined)
		{
			$(this).find(".colorEditBtn>div").css("background", set);
		}
		else
		{
			$(this).find(".colorEditBtn>div").css("background", $(this).attr("data-value"));
		}

		if($(this).attr("data-for") != undefined)
		{
			var rgba = $(this).find(".colorEditBtn>div").css("background-color");
			$("[data-set=" + $(this).attr("data-for") + "]").each(function()
			{
				var css = $(this).attr("data-target");
				if(css == undefined)
					css = "background-color";

				$(this).css(css, rgba);
			});
		}
	});

	var cl = localStorage.getItem("fancyColorpalette");
	if(cl==undefined) cl = "";
	var dac = cl.split(":");

	dac.reverse();
	for(var i in dac)
	{
		if(dac[i].trim() == "")
			continue;

		var color = CEditor.rgba2str(CEditor.str2rgb("#" + dac[i]));
		if(color.r == NaN) continue;

		$(".colorEditor_v2").find(".palette").prepend('<div class="citems" style="background-color:' + color + ';"></div>');
		$(".colorEditor_v2 .palette>.citems").click(function(e)
		{
			CEditor.openColorEditor(this, true);
		});
	}
</script>
<script>
var columnarray = ["encdps", "damage", "crithit%", "maxhit", "swings", "misses", "deaths"];
var columnarrayhps = ["enchps", "healed", "effectiveHeal", "damageShield", "overHeal%"];
var dps = [ 
	"encdps",
	"damage",
	"crithit%",
	"maxhit",
	"swings",
	"misses",
	"deaths",

	"BlockPct",
	"crithits",
	"CritDirectHit%",
	"dps",
	"damage%",
	"damagetaken",
	"DirectHit%",
	"duration",
	"kills",
	"Last10DPS",
	"Last30DPS",
	"Last60DPS",
	"Last180DPS",
	"maxhitstr",
	"maxhitval",
	"ParryPct",
	"tohit"
];

var hps = [
	"enchps",
	"healed",
	"effectiveHeal",
	"damageShield",
	"overHeal%",

	"cures",
	"OverHealPct",
	"absorbHeal",
	"critheal%",
	"critheals",
	"healed%",
	"heals",
	"healstaken",
	"hps",
	"maxheal",
	"maxhealstr",
	"maxhealval",
	"overHeal",
	"powerdrain",
	"powerheal",
];
var smallColumns = ["deaths", "misses", "swings", "hits"];
var largeColumns = ["maxhit", "maxheal"];

if(option.displayeddps == undefined)
{
	for(var i in dps)
	{
		var x = 50;
		if(smallColumns.indexOf(dps[i]) > -1)
			x = 42;
		if(largeColumns.indexOf(dps[i]) > -1)
			x = 150;

		if(columnarray.indexOf(dps[i]) > -1)
			$("#sortable-dps").append("<li dat=\"" + dps[i] + "\" data-view=\"true\">" + dps[i] + "<input type='number' min='42' max='300' value='" + x + "' /></li>");
		else
			$("#sortable-dps").append("<li dat=\"" + dps[i] + "\">" + dps[i] + "<input type='number' min='42' max='300' value='" + x + "' /></li>");
	}
}
else
{
	for(var i in option.displayeddps)
	{
		if(option.displayeddps[i].view)
			$("#sortable-dps").append("<li dat=\"" + option.displayeddps[i].name + "\" data-view=\"" + option.displayeddps[i].view + "\">" + option.displayeddps[i].name + "<input type='number' min='42' max='300' value='" + option.displayeddps[i].width + "' /></li>");
	}

	for(var i in option.displayeddps)
	{
		if(!option.displayeddps[i].view)
			$("#sortable-dps").append("<li dat=\"" + option.displayeddps[i].name + "\" data-view=\"" + option.displayeddps[i].view + "\">" + option.displayeddps[i].name + "<input type='number' min='42' max='300' value='" + option.displayeddps[i].width + "' /></li>");
	}
}

if(option.displayedhps == undefined)
{
	for(var i in hps)
	{
		var x = 50;
		if(smallColumns.indexOf(hps[i]) > -1)
			x = 42;
		if(largeColumns.indexOf(hps[i]) > -1)
			x = 150;

		if(columnarrayhps.indexOf(hps[i]) > -1)
			$("#sortable-hps").append("<li dat=\"" + hps[i] + "\" data-view=\"true\">" + hps[i] + "<input type='number' min='42' max='300' value='" + x + "' /></li>");
		else
			$("#sortable-hps").append("<li dat=\"" + hps[i] + "\">" + hps[i] + "<input type='number' min='42' max='300' value='" + x + "' /></li>");
	}
}
else
{
	for(var i in option.displayedhps)
	{
		if(option.displayedhps[i].view)
			$("#sortable-hps").append("<li dat=\"" + option.displayedhps[i].name + "\" data-view=\"" + option.displayedhps[i].view + "\">" + option.displayedhps[i].name + "<input type='number' min='42' max='300' value='" + option.displayedhps[i].width + "' /></li>");
	}

	for(var i in option.displayedhps)
	{
		if(!option.displayedhps[i].view)
			$("#sortable-hps").append("<li dat=\"" + option.displayedhps[i].name + "\" data-view=\"" + option.displayedhps[i].view + "\">" + option.displayedhps[i].name + "<input type='number' min='42' max='300' value='" + option.displayedhps[i].width + "' /></li>");
	}
}



$("#sortable-dps>li").dblclick(function()
{
	if($(this).attr("data-view") != "true")
	{
		$(this).attr("data-view", "true");
	}
	else
	{
		$(this).attr("data-view", "false");
	}
});

$("#sortable-dps, #sortable-hps").sortable();
$(".group").each(function()
{
	if($(this).attr("tag") != undefined)
	{
		if($(this).attr("tag") != "information")
		{
			$(this).hide();
		}
	}
	else
	{
		$(this).hide();
	}
})

$(".remotecontrol>div").click(function()
{
	$(".remotecontrol>div").removeAttr("data-selected");
	$(this).attr("data-selected","true");
	$(".group").hide();
	$(".group[tag=" + $(this).attr("tag") + "]").show();
});

function colorSave() {
	option.displayeddps = [];
	$("#sortable-dps>li").each(function()
	{
		var width = parseInt($(this).find("input").val());
		if( width < 42 ) width = 50;

		var itemname = $(this).attr("dat");
		var view = $(this).attr("data-view");

		option.displayeddps.push({"name":itemname, "view":view=="true"?!0:!1, "width":width });
	});

	option.displayedhps = [];
	$("#sortable-hps>li").each(function()
	{
		var width = parseInt($(this).find("input").val());
		if( width < 42 ) width = 50;

		var itemname = $(this).attr("dat");
		var view = $(this).attr("data-view");

		option.displayedhps.push({"name":itemname, "view":view=="true"?!0:!1, "width":width });
	});

	$("#sortable-dps").html("");
	$("#sortable-hps").html("");

	for(var i in option.displayeddps)
	{
		if(option.displayeddps[i].view)
			$("#sortable-dps").append("<li dat=\"" + option.displayeddps[i].name + "\" data-view=\"" + option.displayeddps[i].view + "\">" + option.displayeddps[i].name + "<input type='number' min='42' max='300' value='" + option.displayeddps[i].width + "' /></li>");
	}

	for(var i in option.displayeddps)
	{
		if(!option.displayeddps[i].view)
			$("#sortable-dps").append("<li dat=\"" + option.displayeddps[i].name + "\" data-view=\"" + option.displayeddps[i].view + "\">" + option.displayeddps[i].name + "<input type='number' min='42' max='300' value='" + option.displayeddps[i].width + "' /></li>");
	}

	for(var i in option.displayedhps)
	{
		if(option.displayedhps[i].view)
			$("#sortable-hps").append("<li dat=\"" + option.displayedhps[i].name + "\" data-view=\"" + option.displayedhps[i].view + "\">" + option.displayedhps[i].name + "<input type='number' min='42' max='300' value='" + option.displayedhps[i].width + "' /></li>");
	}

	for(var i in option.displayedhps)
	{
		if(!option.displayedhps[i].view)
			$("#sortable-hps").append("<li dat=\"" + option.displayedhps[i].name + "\" data-view=\"" + option.displayedhps[i].view + "\">" + option.displayedhps[i].name + "<input type='number' min='42' max='300' value='" + option.displayedhps[i].width + "' /></li>");
	}
	
	$('#tmp').html('* {font-family:"' + option.fonts + '"}');
	option["backgroundimg"] = $(".imageurlpicker>.imagearea>.image").attr("style");
	window.opener.option = option;
	$(".savebtn").removeClass("alarm");
	window.opener.setCSS();
	saveSetting();
	$("#settingtxt").val(JSON.stringify(option, null, 4));
}

$("select,input").change(function() {
	option[$(this).parent().attr("data-id")] = $(this).val();
	window.opener.setCSS();

	saveSetting();
});

function saveSetting() {
	localStorage.setItem("fancyset", JSON.stringify(option));

	window.opener.option = option;
	if (window.opener.lastCombat != null) {
		window.opener.lastCombat.AttachPets();
		window.opener.lastCombat.resort();
		window.opener.lastCombatHPS.AttachPets();
		window.opener.lastCombatHPS.resort();
	}
	window.opener.createHeader();
	window.opener.listResort();
}

$("input[type=range]").change(function() {
	$(this).parent().find(".view").text($(this).val());
	option[$(this).parent().attr("data-id")] = $(this).val();
	saveSetting();
	return false;
});

$("input[type=range]").on("input", function() {
	$(this).parent().find(".view").text($(this).val());
	option[$(this).parent().attr("data-id")] = $(this).val();
	saveSetting();
	return false;
});

$(".switch").click(function() {
	if ($(this).attr("data-checked") != "true") {
		$(this).attr("data-checked", "true");
	} else {
		$(this).attr("data-checked", "false");
	}

	if ($(this).parent().attr("data-id") != undefined) {
		option[$(this).parent().attr("data-id")] = ($(this).attr("data-checked") == "true" ? true : false);
		saveSetting();
	}
});

$(".item").click(function(e) {
	if (e.target.className == "item" && $(this).find(".switch").length > 0) {
		var $switch = $(this).find(".switch");
		if ($switch.attr("data-checked") != "true") {
			$switch.attr("data-checked", "true");
		} else {
			$switch.attr("data-checked", "false");
		}

		if ($(this).attr("data-id") != undefined) {
			option[$(this).attr("data-id")] = ($switch.attr("data-checked") == "true" ? true : false);
			saveSetting();
		}
	}
});

$(".imageurlpicker").each(function() {
	$(this).html('<div class="inputarea"><input type="text" value="" placeholder="Image URL"/><div class="chk"><i class="material-icons">launch</i></div><div class="deleteimg"><i class="material-icons">delete</i></div></div><div class="imagearea"><div class="image"></div></div><div class="remotectrl"><textarea placeholder="EX) blur(2px) contrast(1.25) ... etc"></textarea><div class="label" data-label="cssfilter"></div><div class="options imagealign" data-id="imgalign" label=""></div><dov class="options sizeoption" data-id="imgsizeopt"><button data-checked="true" data-label="widthfit"></button><button data-checked="false" data-label="heightfit"></button><button data-checked="false" data-label="original"></button></div></div>');
	var This = this;

	$(this).find(".imagealign").append("<button data-checked=\"false\">↖</button>");
	$(this).find(".imagealign").append("<button data-checked=\"false\">↑</button>");
	$(this).find(".imagealign").append("<button data-checked=\"false\">↗</button>");

	$(this).find(".imagealign").append("<button data-checked=\"false\">←</button>");
	$(this).find(".imagealign").append("<button data-checked=\"true\">×</button>");
	$(this).find(".imagealign").append("<button data-checked=\"false\">→</button>");

	$(this).find(".imagealign").append("<button data-checked=\"false\">↙</button>");
	$(this).find(".imagealign").append("<button data-checked=\"false\">↓</button>");
	$(this).find(".imagealign").append("<button data-checked=\"false\">↘</button>");

	$(this).find(".imagealign>button").click(function() {
		$(This).find(".imagealign>button").attr("data-checked", "false");
		$(this).attr("data-checked", "true");

		$(This).find(".chk").trigger("click");
	});

	$(this).find(".sizeoption>button").click(function() {
		$(This).find(".sizeoption>button").attr("data-checked", "false");
		$(this).attr("data-checked", "true");

		$(This).find(".chk").trigger("click");
	});

	$(this).find(".deleteimg").click(function() {
		$(This).find(".image").removeAttr("style");
	});

	$(this).find("[data-label]").each(function() {
		$(this).html(curLang.label[$(this).attr("data-label")]);
	});

	$(this).find("[data-id]").each(function() {
		if (curLang.settings[$(this).attr("data-id")] != undefined)
			$(this).attr("label", curLang.settings[$(this).attr("data-id")]);
	});

	$(this).find(".chk").click(function() {
		if ($(This).find("input").val().trim() == "") return;
		$(This).find(".image").css({
			"background-image": "url(" + $(This).find("input").val() + ")",
			"background-repeat": "no-repeat",
			"filter": $(This).find("textarea").val().trim(),
			"webkitFilter": $(This).find("textarea").val().trim()
		});

		switch ($(This).find(".sizeoption>[data-checked=true]").attr("data-label")) {
			case "widthfit":
				$(This).find(".image").css("background-size", "100% auto");
				break;
			case "heightfit":
				$(This).find(".image").css("background-size", "auto 100%");
				break;
			case "original":
				$(This).find(".image").css("background-size", "auto auto");
				break;
		}

		switch ($(This).find(".imagealign>[data-checked=true]").html()) {
			case "↖":
				$(This).find(".image").css("background-position", "left top");
				break;
			case "↑":
				$(This).find(".image").css("background-position", "center top");
				break;
			case "↗":
				$(This).find(".image").css("background-position", "right top");
				break;
			case "←":
				$(This).find(".image").css("background-position", "left center");
				break;
			case "×":
				$(This).find(".image").css("background-position", "center center");
				break;
			case "→":
				$(This).find(".image").css("background-position", "right center");
				break;
			case "↙":
				$(This).find(".image").css("background-position", "left bottom");
				break;
			case "↓":
				$(This).find(".image").css("background-position", "center bottom");
				break;
			case "↘":
				$(This).find(".image").css("background-position", "right bottom");
				break;
		}
	});
});

for (var i in option) {
	if (i == "backgroundimg") {
		$(".imageurlpicker>.imagearea>.image").attr("style", option[i]);
		$(".imageurlpicker .sizeoption>button").attr("data-checked", "false");

		$(".imageurlpicker textarea").val($(".imageurlpicker>.imagearea>.image").css("filter"));
		if ($(".imageurlpicker textarea").val() == "none")
			$(".imageurlpicker textarea").val($(".imageurlpicker>.imagearea>.image").css("webkitFilter"));
		if ($(".imageurlpicker textarea").val() == "none")
			$(".imageurlpicker textarea").val("");

		$(".imageurlpicker input").val($(".imageurlpicker>.imagearea>.image").css("background-image"));
		$(".imageurlpicker input").val($(".imageurlpicker input").val().replace(/url\((.+)\)/, "$1").replace(/"/, ""));
		if($(".imageurlpicker input").val() == "none")
		{
			$(".imageurlpicker input").val("");
		}

		switch ($(".imageurlpicker>.imagearea>.image").css("background-size")) {
			case "100%":
				$(".imageurlpicker .sizeoption>[data-label=widthfit]").attr("data-checked", "true");
				break;
			case "auto 100%":
				$(".imageurlpicker .sizeoption>[data-label=heightfit]").attr("data-checked", "true");
				break;
			case "auto":
				$(".imageurlpicker .sizeoption>[data-label=original]").attr("data-checked", "true");
				break;
		}

		$(".imageurlpicker .imagealign>button").attr("data-checked", "false");

		switch ($(".imageurlpicker>.imagearea>.image").css("background-position")) {
			case "0% 0%":
				$($(".imageurlpicker .imagealign>button")[0]).attr("data-checked", "true");
				break;
			case "0% 50%":
				$($(".imageurlpicker .imagealign>button")[1]).attr("data-checked", "true");
				break;
			case "0% 100%":
				$($(".imageurlpicker .imagealign>button")[2]).attr("data-checked", "true");
				break;
			case "50% 0%":
				$($(".imageurlpicker .imagealign>button")[3]).attr("data-checked", "true");
				break;
			case "50% 50%":
				$($(".imageurlpicker .imagealign>button")[4]).attr("data-checked", "true");
				break;
			case "50% 100%":
				$($(".imageurlpicker .imagealign>button")[5]).attr("data-checked", "true");
				break;
			case "100% 0%":
				$($(".imageurlpicker .imagealign>button")[6]).attr("data-checked", "true");
				break;
			case "100% 50%":
				$($(".imageurlpicker .imagealign>button")[7]).attr("data-checked", "true");
				break;
			case "100% 100%":
				$($(".imageurlpicker .imagealign>button")[8]).attr("data-checked", "true");
				break;
		}
	} else if ($("[data-id=" + i + "]").length != 0) {
		if (typeof(option[i]) === "boolean")
			$("[data-id=" + i + "]").find(".switch").attr("data-checked", option[i]);
		else if ($("[data-id=" + i + "]").find("select").length > 0) {
			$("[data-id=" + i + "]").find("select").val(option[i]);
		} else {
			var $item = $("[data-id=" + i + "]");

			if ($item.find(".colorpicker").length > 0) {
				var rgba = getstrtorgb(option[i]);
				colorSet($item, rgba);
			} else {
				$item.find("input").val(option[i]);
				$item.find(".view").text(option[i]);
			}
		}
	}
}
$('#tmp').html('* {font-family:"' + option.fonts + '"}');

$("input, select").change(function() {
	$(".savebtn").addClass("alarm");
});
$("#settingtxt").val(JSON.stringify(option, null, 4));

function allowset()
{
	if($("#settingtxt_import").val().trim() != "")
	{
		option = JSON.parse($("#settingtxt_import").val());
		window.opener.option = option;
		window.opener.setCSS();
		saveSetting();
		location.href = location.href;
	}
}
</script>